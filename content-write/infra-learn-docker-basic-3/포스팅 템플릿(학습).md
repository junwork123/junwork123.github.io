---
emoji: ğŸ”®
title: Letâ€™s Go Docker(ì‹¬í™”í¸) - ë³€ê²½ì‚¬í•­ì„ Dockerë¡œ ìë™ ë°°í¬í•˜ê¸°
date: '2022-11-06 00:00:00'
author: ì£¼ë…
tags: ë„ì»¤ Docker IntelliJ SpringBoot Docker VM Container ë„ì»¤
categories: infra
---

ì§€ì ê³¼ ëŒ“ê¸€ì€ ì–¸ì œë‚˜ í™˜ì˜í•©ë‹ˆë‹¤!

<br/>

# ë³€ê²½ì‚¬í•­ì„ Dockerë¡œ ìë™ ë°°í¬í•˜ê¸°

ë³€ê²½ì‚¬í•­ì„ ê°ì§€í•˜ê³  ë°°í¬í•˜ë ¤ë©´

CI/CD íŒŒì´í”„ë¼ì¸ êµ¬ì¶•ì„ ë¨¼ì € ì•Œì•„ì•¼í•œë‹¤.

<br>

CI/CD íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì€ 

ë²„ì „ ê´€ë¦¬ í”Œë«í¼ë³„ë¡œ ë‹¤ë¥´ë‹¤.

<br>

ëŒ€í‘œì ìœ¼ë¡œ Githubì™€ Gitlabì´ ìˆìœ¼ë‹ˆ 

ê°ê° ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ì.

<br>

---

## Github Actionì„ ì´ìš©í•œ CI/CD

<br>

GithubëŠ” ì‚¬ìš©ìê°€ CI/CD ë„êµ¬ë¥¼ ì§ì ‘ í†µí•©í•´ì•¼ í•œë‹¤.

ì„ íƒì§€ë¡œ Jenkins, CircleCI, TravisCI ë“±ì´ ìˆë‹¤

<br>

í•„ìëŠ” í˜„ì¬ ì´ ë¸”ë¡œê·¸ë„ Github Actionìœ¼ë¡œ ìë™ ë°°í¬í•˜ê³  ìˆë‹¤.

ê·¸ ë•Œì˜ [ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸](https://www.junwork.net/blog-build-deploy-2/)ë¥¼  ì¬í™œìš©í•´ë³´ì.

```yaml
name: App Deployment # ì´ ìŠ¤í¬ë¦½íŠ¸ì˜ ì œëª©

# ì–´ë–¤ í–‰ë™ì„ í• ë•Œë§ˆë‹¤ ì‹¤í–‰í• ì§€
on:
  # master, release/v*ë¼ëŠ” ì´ë¦„ì˜ ë¸Œëœì¹˜ì— pushê°€ ë°œìƒí•  ë•Œë§ˆë‹¤
  # ex) release/v0.1, release/v2.1.5
  push:
    branches:
      - master
      - release/v*

  # feature, fix ë¸Œëœì¹˜ì— pull_requestê°€ ë°œìƒí•  ë•Œë§ˆë‹¤
  pull_request:
    branches:
      - feature-*
      - fix-*

# ì‹¤í–‰í•  ì‘ì—…ì„ ì •ì˜
jobs:
  build:
    runs-on: ubuntu-latest
    steps:

    - name: checkout
      uses: actions/checkout@v3

    - name: Set up JDK 11
      uses: actions/setup-java@v3
      with:
        java-version: '11'
        distribution: 'temurin'

    ## create application-database.yaml
    - name: make application-database.yaml
      run: |
        ## create application-database.yaml
        cd ./src/main/resources

        # application-database.yaml íŒŒì¼ ìƒì„±
        touch ./application-database.yaml

        # GitHub-Actions ì—ì„œ ì„¤ì •í•œ ê°’ì„ application-database.yaml íŒŒì¼ì— ì“°ê¸°
        echo "${{ secrets.DATABASE }}" >> ./application-database.yaml
      shell: bash

    ## gradle build
    - name: Build with Gradle
      run: ./gradlew bootJar


    ## ì›¹ ì´ë¯¸ì§€ ë¹Œë“œ ë° ë„ì»¤í—ˆë¸Œì— push
    - name: web docker build and push
      run: |
        docker login -u ${{ secrets.DOCKER_USERNAME }} -p ${{ secrets.DOCKER_PASSWORD }}
        docker build -t ${{ secrets.DOCKER_REPO }}/second-eyes-web .
        docker push ${{ secrets.DOCKER_REPO }}/second-eyes-web

    ## docker compose up
    - name: executing remote ssh commands using password
      uses: appleboy/ssh-action@master
      with:
        host: ${{ secrets.HOST }}
        username: ubuntu
        key: ${{ secrets.KEY }}
        script: |
          sudo docker rm -f $(docker ps -qa)
          sudo docker pull ${{ secrets.DOCKER_REPO }}/second-eyes-web
          sudo docker pull ${{ secrets.DOCKER_REPO }}/second-eyes-nginx
          docker-compose up -d
          docker image prune -f
```

<br>

---

## Gitlabì„ ì´ìš©í•œ CI/CD

<br>

í•œí¸, Gitlabì€ All-in-One DevOpsë¥¼ í‘œë±¡í•˜ê³  ìˆê¸° ë•Œë¬¸ì—

ìì²´ì ìœ¼ë¡œ CI/CD ë„êµ¬ë¥¼ ì œê³µí•œë‹¤.


<br>

---

_ì¶œì²˜_

_[wjdrbs96ë‹˜ ë¸”ë¡œê·¸](https://devlog-wjdrbs96.tistory.com/361)_

_[stalker5217ë‹˜ ë¸”ë¡œê·¸](https://stalker5217.netlify.app/devops/github-action-aws-ci-cd-1/)_

_[rmswjdtnë‹˜ ë¸”ë¡œê·¸](https://velog.io/@rmswjdtn/Spring-Docker-Github-Action-Spring-Boot-%EC%9E%90%EB%8F%99%EB%B0%B0%ED%8F%AC%ED%99%98%EA%B2%BD-%EB%A7%8C%EB%93%A4%EA%B8%B0)_

<br/>

---

```toc

```
