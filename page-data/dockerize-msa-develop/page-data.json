{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/dockerize-msa-develop/",
    "result": {"data":{"cur":{"id":"a4563c8a-1620-5b0e-bd03-ab8b3ddb163e","html":"<p>ì§€ì ê³¼ ëŒ“ê¸€ì€ ì–¸ì œë‚˜ í™˜ì˜í•©ë‹ˆë‹¤!</p>\n<br/>\n<hr>\n<h2 id=\"ëª©í‘œ\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"ëª©í‘œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ëª©í‘œ</h2>\n<p>ë„ì»¤ ê°œì„ í•˜ê¸°ì—ì„œ ì‘ì„±í•œ ë‚´ìš©ì„ ë°œì „ì‹œì¼œë³´ì.</p>\n<br>\n<p>í¬ê²Œ ë‘ íŒŒíŠ¸ë¡œ ë‚˜ëˆ  ë°œì „ì‹œì¼œë³´ê³ ì í•œë‹¤.</p>\n<ul>\n<li>\n<p>ì„œë¹„ìŠ¤ì™€ ìš´ì˜ì˜ ë¶„ë¦¬</p>\n<ul>\n<li>\n<p>ì†ŒìŠ¤ ìœ„ì¹˜, ë²„ì „ ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ì™€ ë¶„ë¦¬í•˜ì.</p>\n</li>\n<li>\n<p>ì„œë¹„ìŠ¤ ì‹¤í–‰í™˜ê²½ ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ì™€ ë¶„ë¦¬í•˜ì.</p>\n</li>\n<li>\n<p>Micro Service ê°„ ì—°ê²° ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ì™€ ë¶„ë¦¬í•˜ì.</p>\n</li>\n</ul>\n</li>\n<li>\n<p>CI/CD (ë‹¤ìŒí¸)</p>\n<ul>\n<li>\n<p>release ë¸Œëœì¹˜ì— pushê°€ ë°œìƒí•˜ë©´ docker ì´ë¯¸ì§€ë¡œ ë°°í¬í•  ìˆ˜ ìˆë„ë¡ í•˜ì</p>\n</li>\n<li>\n<p>ë°°í¬ ë²„ì „ì€ ì»¤ë°‹IDë¥¼ ë„£ì„ ìˆ˜ ìˆë„ë¡ í•˜ì</p>\n</li>\n</ul>\n</li>\n</ul>\n<br>\n<hr>\n<h2 id=\"ì—¬ì •\" style=\"position:relative;\"><a href=\"#%EC%97%AC%EC%A0%95\" aria-label=\"ì—¬ì • permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì—¬ì •</h2>\n<h3 id=\"ì»¨í…Œì´ë„ˆì™€-í”„ë¡œì íŠ¸-ê°„-ì˜ì¡´ì„±-ì œê±°\" style=\"position:relative;\"><a href=\"#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%99%80-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B0%84-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A0%9C%EA%B1%B0\" aria-label=\"ì»¨í…Œì´ë„ˆì™€ í”„ë¡œì íŠ¸ ê°„ ì˜ì¡´ì„± ì œê±° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì»¨í…Œì´ë„ˆì™€ í”„ë¡œì íŠ¸ ê°„ ì˜ì¡´ì„± ì œê±°</h3>\n<ol>\n<li>\n<p>docker ì´ë¯¸ì§€ë¥¼ Registryì— ë“±ë¡</p>\n<p>ê° Dockerfileë§ˆë‹¤ Container Registryì— ë“±ë¡í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ pullí•  ìˆ˜ ìˆë„ë¡ ë“±ë¡</p>\n<p>(ì•„ë˜ ëª…ë ¹ì–´ë“¤ì€ í”„ë¡œì íŠ¸ ë©”ë‰´ > Packages and registries > Container Registryì—ì„œ ë³µì‚¬ ê°€ëŠ¥!)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Gitlabì˜ Private image hubì— ì €ì¥í•  ìˆ˜ ìˆë„ë¡ ë¡œê·¸ì¸</span>\n<span class=\"token function\">docker</span> login registry.gitlab.com\n\n<span class=\"token comment\"># Image naming conventionì— ë”°ë¼ ì•„ë˜ì™€ ê°™ì´ Build ë° Push</span>\n<span class=\"token function\">docker</span> build -t <span class=\"token operator\">&lt;</span>registry URL<span class=\"token operator\">></span>/<span class=\"token operator\">&lt;</span>namespace<span class=\"token operator\">></span>/<span class=\"token operator\">&lt;</span>project<span class=\"token operator\">></span>/<span class=\"token operator\">&lt;</span>image<span class=\"token operator\">></span>:<span class=\"token operator\">&lt;</span>tag<span class=\"token operator\">></span> <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">docker</span> push <span class=\"token operator\">&lt;</span>registry URL<span class=\"token operator\">></span>/<span class=\"token operator\">&lt;</span>namespace<span class=\"token operator\">></span>/<span class=\"token operator\">&lt;</span>project<span class=\"token operator\">></span>/<span class=\"token operator\">&lt;</span>image<span class=\"token operator\">></span>:<span class=\"token operator\">&lt;</span>tag<span class=\"token operator\">></span></code></pre></div>\n</li>\n<li>\n<p>ê¸°ì¡´ Docker ì‹¤í–‰ê´€ë ¨ ì •ë³´ ë¶„ë¦¬</p>\n<ul>\n<li>\n<p>Container ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” Docker Composeìš© Repositoryë¥¼ ìƒˆë¡œ ìƒì„±í•¨.</p>\n<p>â†’ ì„œë¹„ìŠ¤ëŠ” ì„œë¹„ìŠ¤ì—ë§Œ ì§‘ì¤‘í•˜ê¸° ìœ„í•¨ : MSAì˜ íŠ¹ì§•ì¸ ì¸í„°í˜ì´ìŠ¤ í†µì‹ ì„ ì‚´ë ¤ë³´ì</p>\n<ul>\n<li>ì„œë¹„ìŠ¤ì™€ DB : DB ê´€ë ¨ Container ì •ë³´ë¥¼ ëª°ë¼ë„ ë¨</li>\n<li>ì„œë¹„ìŠ¤ì™€ ì„œë¹„ìŠ¤ : ë‹¤ë¥¸ ì„œë¹„ìŠ¤ Container ì •ë³´ë¥¼ ëª°ë¼ë„ ë¨</li>\n</ul>\n</li>\n<li>\n<p>ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§€ê²Œ ë¨</p>\n<ul>\n<li>\n<p>DB Dockerfile</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Database</span>\nFROM postgres:14\n\nENV APPNAME DBinstaller\nENV WORKDIR /home/<span class=\"token variable\">$APPNAME</span>\nWORKDIR <span class=\"token variable\">$WORKDIR</span>\nCOPY conf <span class=\"token variable\">$WORKDIR</span>/conf\n\n<span class=\"token comment\"># íƒ€ì„ì¡´ ì„¤ì •</span>\nRUN <span class=\"token function\">ln</span> -snf /usr/share/zoneinfo/<span class=\"token variable\">$TZ</span> /etc/localtime <span class=\"token punctuation\">\\</span>\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token variable\">$TZ</span> <span class=\"token operator\">></span> /etc/timezone\n\n<span class=\"token comment\"># update ë° íŒ¨í‚¤ì§€ ì„¤ì¹˜, init ëª…ë ¹ì–´ ë“±ë¡</span>\nRUN <span class=\"token function\">apt</span> update <span class=\"token punctuation\">\\</span>\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> -y <span class=\"token function\">sudo</span> <span class=\"token function\">sed</span> <span class=\"token punctuation\">\\</span>\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">cat</span> <span class=\"token variable\">$WORKDIR</span>/conf/init.sh <span class=\"token operator\">>></span> /bin/init <span class=\"token punctuation\">\\</span>\n    <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">chmod</span> u+x /bin/init</code></pre></div>\n</li>\n<li>\n<p>í™˜ê²½ë³€ìˆ˜ ì„¤ì •íŒŒì¼(Compose / DB)</p>\n<ul>\n<li>\n<p>.env íŒŒì¼(Docker Composeìš©)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># .env</span>\n<span class=\"token comment\"># IMAGE=&lt;registry URL>/&lt;namespace>/&lt;project>/&lt;image></span>\n<span class=\"token comment\"># VERSION=&lt;tag></span>\n\n<span class=\"token comment\"># DB Configuration</span>\n<span class=\"token assign-left variable\">DB_IMAGE</span><span class=\"token operator\">=</span>registry.gitlab.com/<span class=\"token punctuation\">..</span>.\n<span class=\"token assign-left variable\">DB_VERSION</span><span class=\"token operator\">=</span>latest\n<span class=\"token assign-left variable\">DB_HOST</span><span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0 <span class=\"token comment\"># ì™¸ë¶€ DBì™€ ì—°ê²°í•˜ê³  ì‹¶ì„ ë•Œ DB IP ì…ë ¥</span>\n<span class=\"token assign-left variable\">DB_ENV_FILE</span><span class=\"token operator\">=</span>.env.db.postgres\n\n<span class=\"token comment\"># SERVICE_B Configuration</span>\n<span class=\"token assign-left variable\">SERVICE_B_IMAGE</span><span class=\"token operator\">=</span>registry.gitlab.com/<span class=\"token punctuation\">..</span>SERVICE_B<span class=\"token punctuation\">..</span>\n<span class=\"token assign-left variable\">SERVICE_B_VERSION</span><span class=\"token operator\">=</span>latest\n<span class=\"token assign-left variable\">SERVICE_B_IP</span><span class=\"token operator\">=</span><span class=\"token number\">0.0</span>.0.0 <span class=\"token comment\"># ê´€ë¦¬ë„êµ¬ë¥¼ ì‹¤í–‰í•  í˜¸ìŠ¤íŠ¸ì˜ IPë¡œ ë³€ê²½</span>\n<span class=\"token assign-left variable\">SERVICE_B_NAME</span><span class=\"token operator\">=</span>SERVICE_B1\n\n<span class=\"token comment\"># SERVICE_D Configuration</span>\n<span class=\"token assign-left variable\">SERVICE_D_IMAGE</span><span class=\"token operator\">=</span>registry.gitlab.com/<span class=\"token punctuation\">..</span>SERVICE_D<span class=\"token punctuation\">..</span>\n<span class=\"token assign-left variable\">SERVICE_D_VERSION</span><span class=\"token operator\">=</span>latest\n<span class=\"token assign-left variable\">SERVICE_D_NAME</span><span class=\"token operator\">=</span>kit1\n\n<span class=\"token comment\"># Ports</span>\n<span class=\"token assign-left variable\">DB_PORT_IN</span><span class=\"token operator\">=</span><span class=\"token number\">5432</span>\n<span class=\"token assign-left variable\">DB_PORT_OUT</span><span class=\"token operator\">=</span><span class=\"token number\">5432</span>\n<span class=\"token assign-left variable\">SERVICE_B_PORT_IN</span><span class=\"token operator\">=</span><span class=\"token number\">8080</span>\n<span class=\"token assign-left variable\">SERVICE_B_PORT_OUT</span><span class=\"token operator\">=</span><span class=\"token number\">8080</span>\n<span class=\"token assign-left variable\">SERVICE_D_PORT_IN</span><span class=\"token operator\">=</span><span class=\"token number\">8888</span>\n<span class=\"token assign-left variable\">SERVICE_D_PORT_OUT</span><span class=\"token operator\">=</span><span class=\"token number\">8888</span>\n<span class=\"token assign-left variable\">SERVICE_D_CACHE_PORT_IN</span><span class=\"token operator\">=</span><span class=\"token number\">8900</span>\n<span class=\"token assign-left variable\">SERVICE_D_CACHE_PORT_OUT</span><span class=\"token operator\">=</span><span class=\"token number\">8900</span></code></pre></div>\n</li>\n<li>\n<p>.env.db íŒŒì¼(DBìš©)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># DB Configuration</span>\n<span class=\"token assign-left variable\">DB_NAME</span><span class=\"token operator\">=</span><span class=\"token string\">\"sf1_db\"</span>\n<span class=\"token assign-left variable\">DB_SCHEMA_NAME</span><span class=\"token operator\">=</span><span class=\"token string\">\"sf1_schema\"</span>\n<span class=\"token assign-left variable\">DB_USER</span><span class=\"token operator\">=</span>postgres\n<span class=\"token assign-left variable\">DB_PASSWORD</span><span class=\"token operator\">=</span>0000\n<span class=\"token assign-left variable\">TZ</span><span class=\"token operator\">=</span>Asia/Seoul\n\n<span class=\"token comment\"># Postgresql</span>\n<span class=\"token assign-left variable\">POSTGRES_PASSWORD</span><span class=\"token operator\">=</span><span class=\"token variable\">${DB_PASSWORD}</span>\n<span class=\"token assign-left variable\">DB_KIND</span><span class=\"token operator\">=</span>postgresql <span class=\"token comment\"># oracle, tibero</span>\n<span class=\"token assign-left variable\">DB_DIALECT</span><span class=\"token operator\">=</span><span class=\"token string\">\"org.hibernate.dialect.PostgreSQL10Dialect\"</span>\n<span class=\"token assign-left variable\">DB_DRIVER_CLASS_NAME</span><span class=\"token operator\">=</span><span class=\"token string\">\"org.postgresql.Driver\"</span>\n<span class=\"token assign-left variable\">DB_TYPE</span><span class=\"token operator\">=</span><span class=\"token string\">\"postgresql_table\"</span></code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>Docker Compose</p>\n<ul>\n<li>\n<p>Docker-compose.yml</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Docker compose</span>\nservices:\n    database:\n        env_file: <span class=\"token variable\">${DB_ENV_FILE}</span>\n        image: <span class=\"token variable\">${DB_IMAGE}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${DB_VERSION}</span>\n        container_name: db_instance\n        restart: unless-stopped\n        ports:\n          - <span class=\"token variable\">${DB_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${DB_PORT_OUT}</span>\n        volumes:\n          - sf1_db_storage:/var/lib/postgresql/data\n        healthcheck:\n          test: <span class=\"token punctuation\">[</span><span class=\"token string\">\"CMD\"</span>, <span class=\"token string\">\"pg_isready\"</span>, <span class=\"token string\">\"-U\"</span>, <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">]</span>\n          interval: 10s\n          timeout: 3s\n          retries: <span class=\"token number\">3</span>\n\n    SERVICE_B:\n        env_file: <span class=\"token variable\">${DB_ENV_FILE}</span>\n        image: <span class=\"token variable\">${SERVICE_B_IMAGE}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_B_VERSION}</span>\n        container_name: SERVICE_B\n        restart: always\n        depends_on:\n          database:\n            condition: service_healthy\n        ports:\n          - <span class=\"token variable\">${SERVICE_B_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_B_PORT_OUT}</span>\n        environment:\n          NODENAME: <span class=\"token variable\">${SERVICE_B_NAME}</span>\n          DB_PORT: <span class=\"token variable\">${DB_PORT_OUT}</span>\n          DB_HOST: db_instance\n\n    SERVICE_D:\n        env_file: <span class=\"token variable\">${DB_ENV_FILE}</span>\n        image: <span class=\"token variable\">${SERVICE_D_IMAGE}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_D_VERSION}</span>\n        container_name: SERVICE_D\n        restart: always\n        depends_on:\n          database:\n              condition: service_healthy\n        ports:\n          - <span class=\"token variable\">${SERVICE_D_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_D_PORT_OUT}</span>\n          - <span class=\"token variable\">${SERVICE_D_CACHE_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_D_CACHE_PORT_OUT}</span>\n        environment:\n          NODENAME: <span class=\"token variable\">${SERVICE_D_NAME}</span>\n          DB_PORT: <span class=\"token variable\">${DB_PORT_OUT}</span>\n          DB_HOST: db_instance\n          SERVICE_B_IP: <span class=\"token variable\">${SERVICE_B_IP}</span>\nvolumes:\n  sf1_db_storage:\n    driver: <span class=\"token builtin class-name\">local</span></code></pre></div>\n</li>\n<li>\n<p>Docker-compose.external-db.yml</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Docker compose</span>\nservices:\n  SERVICE_B:\n    env_file: <span class=\"token variable\">${DB_ENV_FILE}</span>\n    image: <span class=\"token variable\">${SERVICE_B_IMAGE}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_B_VERSION}</span>\n    container_name: SERVICE_B\n    restart: always\n    ports:\n      - <span class=\"token variable\">${SERVICE_B_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_B_PORT_OUT}</span>\n    environment:\n      NODENAME: <span class=\"token variable\">${SERVICE_B_NAME}</span>\n      DB_PORT: <span class=\"token variable\">${DB_PORT_OUT}</span>\n      DB_HOST: <span class=\"token variable\">${DB_HOST}</span>\n\n  SERVICE_D:\n    env_file: <span class=\"token variable\">${DB_ENV_FILE}</span>\n    image: <span class=\"token variable\">${SERVICE_D_IMAGE}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_D_VERSION}</span>\n    container_name: SERVICE_D\n    restart: always\n    ports:\n      - <span class=\"token variable\">${SERVICE_D_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_D_PORT_OUT}</span>\n      - <span class=\"token variable\">${SERVICE_D_CACHE_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_D_CACHE_PORT_OUT}</span>\n    environment:\n      NODENAME: <span class=\"token variable\">${SERVICE_D_NAME}</span>\n      DB_PORT: <span class=\"token variable\">${DB_PORT_OUT}</span>\n      DB_HOST: <span class=\"token variable\">${DB_HOST}</span>\n      SERVICE_B_IP: <span class=\"token variable\">${SERVICE_B_IP}</span></code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>Compose ë™ì‘ í™•ì¸</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># ê¸°ì¡´ê³¼ ë˜‘ê°™ì´ ì‹¤í–‰</span>\n<span class=\"token function\">docker-compose</span> up -d\n\n<span class=\"token comment\"># ì™¸ë¶€ DB ì‹¤í–‰</span>\n<span class=\"token comment\"># docker compose -f .\\docker-compose-external-db.yml up -d</span>\n\n<span class=\"token comment\"># DB ì»¨í…Œì´ë„ˆì—ì„œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</span>\n<span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> -it db_instance init\n\n<span class=\"token comment\"># ì¢…ë£Œ</span>\n<span class=\"token function\">docker</span> compose down -v</code></pre></div>\n</li>\n</ul>\n</li>\n</ol>\n<br>\n<hr>\n<h2 id=\"q--a\" style=\"position:relative;\"><a href=\"#q--a\" aria-label=\"q  a permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Q &#x26; A</h2>\n<ul>\n<li>\n<p>DinD vs DooDì˜ ì°¨ì´ê°€ ë­”ê°€ìš”?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACBUlEQVQoz3WR32/ScBTF+bv36h/ggxp9UBOdvihuOPeLzWXMRHFsskEY40dLS0u/pbRQCv1B+dGPWXVmWeZJTu7Dvefk3HszUTynqQt6XogI5jjRAseb0Oj2aGoG+jigHy4w/Rjhx5jBnEkUIxl9GkMffRqztnfGUdvgBhknnHPcNihIgkJnwDdtREm1yNU0Dtsmm7Uun6oq2y2LQ8Uh17IoWz75msJBNktOtnn6s8Gu4gIJmeFsybnpcaFZVHo2ZTGmqA7I1gX7LZOc5PCx7bBxpbMpD8nKLmemR6GucPH2BTtNwUlLpWiFkKzI2NGCoj7ktCP4pTuUxJiycKnrfYoXl1RVwabiIStd5O0P1FSDqjtjq1jny9oj1q96PJENjo3pH8PxbMGpOaEkPErmhMuBT2MUogwnvN7J871aZ0f3EarCfOM5tu1wOZhSlE0KRz8oaC4HPY/KwIckIcMDkMYR7cGIV1t7XPcG5M0ZfcvBOz6iJnVpOv5DMpKbpyRJwi1XSZI22m6E7His73+lohoc2ksszaD37DFSp4vkxal8tVz+093UNOFdw+SvoTyeodguLz9v09BFmnDXCDmZwK4R0RoF6dzqnja5v/Jtwvow4Lw/Ya/aoqjZbOgR79SQ9x2fN50gvfHd+bt4cGXLn1G2ply7MVU7SFlzwpQVO8AO4v8m/A0m1OIA9PMOqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Untitled\"\n        title=\"Untitled\"\n        src=\"/static/c8231c053eb45162ab16d245df3c67ef/8c557/dind.png\"\n        srcset=\"/static/c8231c053eb45162ab16d245df3c67ef/e9ff0/dind.png 180w,\n/static/c8231c053eb45162ab16d245df3c67ef/f21e7/dind.png 360w,\n/static/c8231c053eb45162ab16d245df3c67ef/8c557/dind.png 700w\"\n        sizes=\"(max-width: 700px) 100vw, 700px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<blockquote>\n<p>DockerëŠ” ìœ„ì™€ ê°™ì´ 3ê°€ì§€ ìœ ë‹›(Client, Host(Daemon), Registry) ìœ¼ë¡œ ë¶„ë¦¬ëœë‹¤.</p>\n</blockquote>\n<ul>\n<li>\n<p>DinD(Docker in Docker)</p>\n<p>ë„ì»¤ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— í˜¸ìŠ¤íŠ¸ ë„ì»¤ ë°ëª¬ê³¼ëŠ” ë³„ê°œì˜ ìƒˆë¡œìš´ ë„ì»¤ ë°ëª¬ì„ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì´ë‹¤. DinDë¥¼ ì´ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒˆë¡œìš´ ë„ì»¤ ë°ëª¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œí‚¬ ë•Œ, â€”privileged ì˜µì…˜ì„ ì‚¬ìš©í•˜ê²Œ ëœë‹¤. ì´ ì˜µì…˜ì€ ì»¨í…Œì´ë„ˆê°€ í˜¸ìŠ¤íŠ¸ ë¨¸ì‹ ì˜ ëŒ€ë¶€ë¶„ì˜ ê¶Œí•œì„ ì–»ì„ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. ì´ëŠ” ë³´ì•ˆìƒ ëŒ€ë¶€ë¶„ì˜ ê¶Œí•œì„ íšë“í•˜ê¸° ë•Œë¬¸ì— DinDëŠ” ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ë°©ë²•ì´ ë˜ì—ˆë‹¤.</p>\n</li>\n<li>\n<p>DooD (Docker Out Of Docker)</p>\n<p>í˜¸ìŠ¤íŠ¸ ë„ì»¤ ë°ëª¬ì´ ì‚¬ìš©í•˜ëŠ” ì†Œì¼“ì„ ê³µìœ í•˜ì—¬ ë„ì»¤ í´ë¼ì´ì–¸íŠ¸ ì»¨í…Œì´ë„ˆì—ì„œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì´ë‹¤. ì´ ë°©ë²•ì€ ë„ì»¤ í´ë¼ì´ì–¸íŠ¸ ì»¨í…Œì´ë„ˆì— â€”privileged ì˜µì…˜ì„ ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— DinDë³´ë‹¤ëŠ” ì•ˆì „í•˜ë‹¤. í•˜ì§€ë§Œ ì»¨í…Œì´ë„ˆ ì´ë¦„ ì¶©ëŒ, í¬íŠ¸ ì¶©ëŒ ê°€ëŠ¥ì„±ì´ ìˆê³ , ì†Œì¼“ ë§ˆìš´íŠ¸ ê²½ë¡œê°€ í˜¸ìŠ¤íŠ¸ì— ì˜ì¡´í•˜ê²Œ ëœë‹¤ëŠ” ë‹¨ì ì´ ìˆë‹¤.</p>\n</li>\n</ul>\n</li>\n<li>\n<p>Compose CLI ì»¤ë§¨ë“œ â€”env-file ì˜µì…˜ vs ComposeíŒŒì¼ì˜ env_file ì˜µì…˜ì˜ ì°¨ì´ê°€ ë­”ê°€ìš”?</p>\n<ul>\n<li>\n<p>â€”env-file : Docker compose íŒŒì¼ ì•ˆì—ì„œ envíŒŒì¼ì„ í™˜ê²½ë³€ìˆ˜ë¡œ ì°¸ì¡°í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.</p>\n</li>\n<li>\n<p>env_file : í•´ë‹¹ envíŒŒì¼ì˜ í™˜ê²½ë³€ìˆ˜ëŠ” compose íŒŒì¼ì—ì„œ ì°¸ì¡°í•  ìˆ˜ ì—†ìœ¼ë©°, Dockerfile ë‚´ì—ì„œë§Œ ìœ íš¨í•˜ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># env_file ì˜µì…˜ì€ ì•„ë˜ì™€ ê°™ì€ íš¨ë ¥ì„ ì§€ë‹Œë‹¤.</span>\n<span class=\"token function\">docker</span> run --env-file<span class=\"token operator\">=</span>FILE â€¦</code></pre></div>\n</li>\n</ul>\n</li>\n</ul>\n<br>\n<hr>\n<h2 id=\"ë§ˆì¹˜ë©°\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"ë§ˆì¹˜ë©° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë§ˆì¹˜ë©°</h2>\n<p>ë‹¤ìŒí¸ì€ ëŒ€ë§ì˜ ë§ˆì§€ë§‰í¸ìœ¼ë¡œ</p>\n<p>CI/CDë¥¼ í†µí•´ ì§€ê¸ˆê¹Œì§€ í–ˆë˜ ì‘ì—…ì„ ìë™í™”í•´ë³¼ ê²ƒì´ë‹¤.</p>\n<p>release ë¸Œëœì¹˜ì— pushê°€ ë°œìƒí•˜ë©´ docker ì´ë¯¸ì§€ë¡œ ë°°í¬í•¨ìœ¼ë¡œì¨</p>\n<p>Micro Service ê°¯ìˆ˜ë§Œí¼ Docker Build - Pushí•˜ëŠ” ë°˜ë³µì‘ì—…ì„ ìµœì†Œí™”í•´ë³´ì.</p>\n<br>\n<hr>\n<p><em>ì°¸ê³ ìë£Œ</em></p>\n<p><em><a href=\"https://aidanbae.github.io/code/docker/dinddood/\">DinD(docker in docker)ì™€ DooD(docker out of docker) | ì•„ì´ë‹¨ì€ ì–´ë””ê°”ì„ê¹Œ (aidanbae.github.io)</a></em></p>\n<p><em><a href=\"https://workshop.infograb.io/gitlab-ci/33_add_docker_build_stage/2_add_build_stage/\"><code class=\"language-text\">.gitlab-ci.yml</code> íŒŒì¼ì— Docker ì´ë¯¸ì§€ ë¹Œë“œ ë‹¨ê³„ ì¶”ê°€ - GitLab CI Workshop (infograb.io)</a></em></p>\n<p><em><a href=\"https://medium.com/monday-9-pm/ci-cd-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EA%B5%AC%EC%B6%95%EA%B8%B0-2-f96b1217279e\">CI/CD í”„ë¡œì„¸ìŠ¤ êµ¬ì¶•ê¸° 2. íŒŒì´í”„ë¼ì¸ êµ¬ì„± | by kyeong su kim | ì›”ìš”ì¼ ì˜¤í›„ 9ì‹œ | Medium</a></em></p>\n<p><em><a href=\"https://hihellloitland.tistory.com/65\">GitLab Runner ë¥¼ ì‚¬ìš©í•˜ì—¬ GitLab CI êµ¬ì„±í•˜ê¸° (tistory.com)</a></em></p>\n<p><em><a href=\"https://otrodevym.tistory.com/entry/CICD-window%EC%97%90%EC%84%9C-Gitlab-CICD%EB%A5%BC-docker%EB%A1%9C-%EB%B0%B0%ED%8F%AC%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95\">[Gitlab-CI/CD] windowì—ì„œ Gitlab CI/CDë¥¼ dockerë¡œ ë°°í¬í•˜ëŠ” ë°©ë²• (tistory.com)</a></em></p>\n<p><em><a href=\"https://yoonsu.tistory.com/25\">[GitLab] docker-composeë¥¼ ì´ìš©í•˜ì—¬ GitLab Runnerì¶”ê°€í•˜ê¸° (tistory.com)</a></em></p>\n<p><em><a href=\"https://ekwkqk12.tistory.com/32\">[Gitlab] CI/GitLab Container Registry (tistory.com)</a></em></p>\n<hr>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%AA%A9%ED%91%9C\">ëª©í‘œ</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%97%AC%EC%A0%95\">ì—¬ì •</a></p>\n<ul>\n<li><a href=\"#%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88%EC%99%80-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B0%84-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%A0%9C%EA%B1%B0\">ì»¨í…Œì´ë„ˆì™€ í”„ë¡œì íŠ¸ ê°„ ì˜ì¡´ì„± ì œê±°</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#q--a\">Q &#x26; A</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">ë§ˆì¹˜ë©°</a></p>\n</li>\n</ul>\n</div>","excerpt":"ì§€ì ê³¼ ëŒ“ê¸€ì€ ì–¸ì œë‚˜ í™˜ì˜í•©ë‹ˆë‹¤! ëª©í‘œ ë„ì»¤ ê°œì„ í•˜ê¸°ì—ì„œ ì‘ì„±í•œ ë‚´ìš©ì„ ë°œì „ì‹œì¼œë³´ì. í¬ê²Œ ë‘ íŒŒíŠ¸ë¡œ ë‚˜ëˆ  ë°œì „ì‹œì¼œë³´ê³ ì í•œë‹¤. ì„œë¹„ìŠ¤ì™€ ìš´ì˜ì˜ ë¶„ë¦¬ ì†ŒìŠ¤ ìœ„ì¹˜, ë²„ì „ ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ì™€ ë¶„ë¦¬í•˜ì. ì„œë¹„ìŠ¤ ì‹¤í–‰í™˜ê²½ ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ì™€ ë¶„ë¦¬í•˜ì. Micro Service ê°„ ì—°ê²° ì •ë³´ë¥¼ ì„œë¹„ìŠ¤ì™€ ë¶„ë¦¬í•˜ì. CI/CD (ë‹¤ìŒí¸) release ë¸Œëœì¹˜ì— pushê°€ ë°œìƒí•˜ë©´ docker ì´ë¯¸ì§€ë¡œ ë°°í¬í•  ìˆ˜ ìˆë„ë¡ í•˜ì ë°°í¬ ë²„ì „ì€ ì»¤ë°‹IDë¥¼ ë„£ì„ ìˆ˜ ìˆë„ë¡ í•˜ì ì—¬ì • ì»¨í…Œì´ë„ˆì™€ í”„ë¡œì íŠ¸ ê°„ ì˜ì¡´ì„± ì œê±° docker ì´ë¯¸ì§€ë¥¼ Registryì— ë“±ë¡ ê° Dockerfileë§ˆë‹¤ Container Registryì— ë“±ë¡í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ pullí•  ìˆ˜ ìˆë„ë¡ ë“±ë¡ (ì•„ë˜ ëª…ë ¹ì–´ë“¤ì€ í”„ë¡œì íŠ¸ ë©”ë‰´ > Packages and registries > Container Registryì—ì„œ ë³µì‚¬ ê°€ëŠ¥!) ê¸°ì¡´ Docker ì‹¤í–‰ê´€ë ¨ ì •ë³´ ë¶„ë¦¬ Container ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆëŠ” Docker Composeìš© Reposâ€¦","frontmatter":{"date":"December 29, 2022","title":"MSA ë„ì»¤ë¼ì´ì§•(Dockerizing) 3í¸, ë°œì „í•˜ê¸°","categories":"infra","author":"ì£¼ë…","emoji":"ğŸ”®"},"fields":{"slug":"/dockerize-msa-develop/"}},"next":{"id":"aed9ef66-df48-5c4d-9b10-c864fd28227d","html":"<p>ì§€ì ê³¼ ëŒ“ê¸€ì€ ì–¸ì œë‚˜ í™˜ì˜í•©ë‹ˆë‹¤!</p>\n<br>\n<hr>\n<br>\n<h1 id=\"ë„ì»¤-ì‚½ì§ˆ-ê°œì„ í•˜ê¸°\" style=\"position:relative;\"><a href=\"#%EB%8F%84%EC%BB%A4-%EC%82%BD%EC%A7%88-%EA%B0%9C%EC%84%A0%ED%95%98%EA%B8%B0\" aria-label=\"ë„ì»¤ ì‚½ì§ˆ ê°œì„ í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë„ì»¤ ì‚½ì§ˆ ê°œì„ í•˜ê¸°</h1>\n<br>\n<h2 id=\"ì´ì „í¸-ìš”ì•½\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EC%A0%84%ED%8E%B8-%EC%9A%94%EC%95%BD\" aria-label=\"ì´ì „í¸ ìš”ì•½ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì´ì „í¸ ìš”ì•½</h2>\n<p>ì´ì „ í¸ <a href=\"https://www.junwork.net/dockerize-msa-basic/\">ë„ì»¤ ì‚½ì§ˆí•˜ê¸°</a> ì—ì„œëŠ” ë‹¨ìˆœ ë¦¬ëˆ…ìŠ¤ ì»¨í…Œì´ë„ˆë¥¼ ìƒì„±í•´ì„œ</p>\n<p>ì§ì ‘ ëª…ë ¹ì–´ë¥¼ íƒ€ì´í•‘í•˜ë©´ì„œ, ì»¨í…Œì´ë„ˆì˜ ìƒíƒœë¥¼ ë³€ê²½í•˜ì˜€ë‹¤.</p>\n<br>\n<p>ê·¸ ê²°ê³¼, ì»¨í…Œì´ë„ˆê°€ ì¬ë¶€íŒ…ë˜ë©´ ëŒ€ë¶€ë¶„ì˜ ë°ì´í„°ì™€ ìƒíƒœê°€ ì†Œì‹¤ë˜ì–´</p>\n<p>ê°™ì€ ê³¼ì •ì„ ë°˜ë³µí•´ì•¼ í–ˆë‹¤.</p>\n<br>\n<hr>\n<br>\n<h2 id=\"ëª©í‘œ\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"ëª©í‘œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ëª©í‘œ</h2>\n<p>ë„ì»¤ ì»¨í…Œì´ë„ˆ ì„¤ì •ì„ ê°„ì†Œí™”, ìë™í™”í•´ë³´ì</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.00000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACf0lEQVQoz22Sy09TQRSH+6/4v7gyJorGnRFNDEskutBERBGjxI1gdQGEiFHBBykg7/JGKPRFS6EiLfRBW/ru7W2hpb2PT9tb0IW/ZOaczJz5zpyZo0tFDzH2dOCcGaUiVVFQVVXzVfXMD4fC7Pg2OC7mqAVWpqr9N17nGhtAf/sKC+MaUFEUZFUbkiJXbUWvX7bzpKOBeNKDtGclYZsgYZ8m6zSiZA9RToHNX0ycuz/Izb41VEXifwpG4+i7ehiamgO5RMmzSnh9HO/SMPmtORDCtUgV3fxOlFH7Psl0proUKwpMxTcwJpxMxOzYsnsUikUcDgexeLR6SHLPkFgxsG38juocRoxH2IwUSOVL6KqQRA4VrbSvhz84v9JCnaWdC2tt3LB1IspHBCNHuPxH7HsC5L49ROy/hzDwgGJ/I0HLLC9mE1h8WQ3o8GZx+bL4gid0bs9St/yUa9NtXJ56TIPjDYKco5JPKKikwwfkB5sJ9Dax29VI8n0Ti+NGno36sPsFDSjJCmKhhFSE7r05LprauLrQxqXFVurNb9lLpzg+lsmXQIxFSAw8IvqukYPeOxx/asK1MMnzyRA2n4Du9MurLQDMJBxc33jFLXM39Q49d9f72fCm+OnPsu0X2dyJETDoyRlaiQ62I4+0cOAyo19O4gyK2g0rUKUGDhVSjEXMfHCu8dW7iklwnyXTJEHQSsQ2z65pkZNfS5RzKcQTlbKkaMBq/9WArlyAPo+RLouBLusQw+F18uVilVn5NqWQp7A1i3/+M7vTH8lYRlBTgb9tcwo8LT1azGARvFjTXixpD1tikLIinz2KKpWQYx7KYTcnITdyxI1ylNH2/jT2b6+3Db80o/CtAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"msa\"\n        title=\"msa\"\n        src=\"/static/c4fef21cd9c5f1b37ad7342abc8dbf37/37523/msa.png\"\n        srcset=\"/static/c4fef21cd9c5f1b37ad7342abc8dbf37/e9ff0/msa.png 180w,\n/static/c4fef21cd9c5f1b37ad7342abc8dbf37/f21e7/msa.png 360w,\n/static/c4fef21cd9c5f1b37ad7342abc8dbf37/37523/msa.png 720w,\n/static/c4fef21cd9c5f1b37ad7342abc8dbf37/302a4/msa.png 1080w,\n/static/c4fef21cd9c5f1b37ad7342abc8dbf37/5d942/msa.png 1343w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>\n<p>ê³µí†µ ì„¤ì • ë¶„ë¦¬ â†’ env íŒŒì¼ ìƒì„±</p>\n</li>\n<li>\n<p>DBì— ëŒ€í•œ dockerfile ì‘ì„± â†’ ì´ë¯¸ì§€ ìƒì„±</p>\n</li>\n<li>\n<p>Package(ì„œë¸Œë„ë©”ì¸B, ì§€ì›ë„ë©”ì¸D)ì— ëŒ€í•œ dockerfile ì‘ì„± â†’ ì´ë¯¸ì§€ ìƒì„±</p>\n</li>\n<li>\n<p>docker-composeë¥¼ ì´ìš©í•´ì„œ ì‹¤í–‰</p>\n</li>\n</ul>\n<br>\n<hr>\n<h2 id=\"ì—¬ì •\" style=\"position:relative;\"><a href=\"#%EC%97%AC%EC%A0%95\" aria-label=\"ì—¬ì • permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì—¬ì •</h2>\n<ol>\n<li>\n<p>env íŒŒì¼ë¡œ ì„¤ì • ë¶„ë¦¬</p>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token comment\"># DB Configuration</span>\nTZ=Asia/Seoul\nDB_HOST=0.0.0.0 # ì™¸ë¶€ DBì™€ ì—°ê²°í•˜ê³  ì‹¶ì„ ë•Œ DB IP ì…ë ¥\nDB_KIND=postgresql # oracle, tibero\nDB_NAME=db\nDB_SCHEMA_NAME=schema\nDB_USER=postgres\nDB_PASSWORD=0000\nDB_PORT_IN=5432\nDB_PORT_OUT=5432\n\n<span class=\"token comment\"># SERVICE_B Configuration</span>\nSERVICE_B_IP=0.0.0.0 # ê´€ë¦¬ë„êµ¬ë¥¼ ì‹¤í–‰í•  í˜¸ìŠ¤íŠ¸ì˜ IPë¡œ ë³€ê²½\nSERVICE_B_NAME=SERVICE_B\nSERVICE_B_PORT_IN=8080\nSERVICE_B_PORT_OUT=8080\n\n<span class=\"token comment\"># SERVICE_D Configuration</span>\nSERVICE_D_NAME=kit1\nSERVICE_D_PORT_IN=8888\nSERVICE_D_PORT_OUT=8888\nSERVICE_D_CACHE_PORT_IN=8900\nSERVICE_D_CACHE_PORT_OUT=8900</code></pre></div>\n</li>\n<li>\n<p>SERVICE_Bì— ëŒ€í•œ dockerfile ì‘ì„±</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># database.properties ì„¤ì •íŒŒì¼ ì˜ˆì‹œ</span>\n\nschema.name=$<span class=\"token punctuation\">{</span>DB_SCHEMA_NAME<span class=\"token punctuation\">}</span>\nspring.datasource.username=$<span class=\"token punctuation\">{</span>DB_USER<span class=\"token punctuation\">}</span>\nspring.datasource.password=$<span class=\"token punctuation\">{</span>DB_PASSWORD<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\"># Postgresql</span>\nspring.datasource.url=jdbc<span class=\"token punctuation\">:</span>postgresql<span class=\"token punctuation\">:</span>//$<span class=\"token punctuation\">{</span>DB_HOST<span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">{</span>DB_PORT<span class=\"token punctuation\">}</span>/$<span class=\"token punctuation\">{</span>DB_NAME<span class=\"token punctuation\">}</span><span class=\"token punctuation\">?</span>useUnicode=true<span class=\"token important\">&amp;characterEncoding=utf8&amp;currentSchema=$</span><span class=\"token punctuation\">{</span>DB_SCHEMA_NAME<span class=\"token punctuation\">}</span>\nspring.datasource.driver<span class=\"token punctuation\">-</span>class<span class=\"token punctuation\">-</span>name=org.postgresql.Driver\nspring.jpa.hibernate.dialect=org.hibernate.dialect.PostgreSQL10Dialect</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token comment\"># APPLICATION</span>\n<span class=\"token instruction\"><span class=\"token keyword\">FROM</span> openjdk:8-jdk-alpine</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> APPNAME SERVICE_B</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> WORKDIR /home/<span class=\"token variable\">$APPNAME</span></span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> <span class=\"token variable\">$WORKDIR</span></span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> ./target/lib <span class=\"token variable\">$WORKDIR</span>/lib</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> ./conf <span class=\"token variable\">$WORKDIR</span>/conf</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span>  ./target/SERVICE_B-7.1.0.jar <span class=\"token variable\">$WORKDIR</span>/lib/SERVICE_B-7.1.0.jar</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENTRYPOINT</span> [ <span class=\"token string\">\"java\"</span>, ... ]</span></code></pre></div>\n</li>\n<li>\n<p>SERVICE_Dì— ëŒ€í•œ dockerfile ì‘ì„±</p>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token comment\"># SERVICE_D</span>\n<span class=\"token instruction\"><span class=\"token keyword\">FROM</span> openjdk:8-jdk-alpine</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> APPNAME SERVICE_D</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> WORKDIR /home/<span class=\"token variable\">$APPNAME</span></span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> <span class=\"token variable\">$WORKDIR</span></span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> ark  <span class=\"token variable\">$WORKDIR</span>/ark</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> conf <span class=\"token variable\">$WORKDIR</span>/conf</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> ./target/SERVICE_D-7.1.0.jar <span class=\"token variable\">$WORKDIR</span>/app.jar</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENTRYPOINT</span> [<span class=\"token string\">\"java\"</span>, <span class=\"token string\">\"-jar\"</span>, <span class=\"token string\">\"app.jar\"</span>,<span class=\"token string\">\"$NODENAME\"</span>, <span class=\"token string\">\"start\"</span> ]</span></code></pre></div>\n</li>\n<li>\n<p>DBì— ëŒ€í•œ dockerfile ì‘ì„± ë° ì´ë¯¸ì§€ ë¹Œë“œ</p>\n<ul>\n<li>\n<p>ì»¨í…Œì´ë„ˆ ë‚´ë¶€ DB ì´ìš©í•˜ëŠ” ê²½ìš°(Docker_db íŒŒì¼)</p>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token comment\"># Database</span>\n<span class=\"token instruction\"><span class=\"token keyword\">FROM</span> postgres:14</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> APPNAME DBinstaller</span>\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> WORKDIR /home/<span class=\"token variable\">$APPNAME</span></span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> <span class=\"token variable\">$WORKDIR</span></span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> conf <span class=\"token variable\">$WORKDIR</span>/conf</span>\n\n<span class=\"token comment\"># íƒ€ì„ì¡´ ì„¤ì •</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> ln -snf /usr/share/zoneinfo/<span class=\"token variable\">$TZ</span> /etc/localtime <span class=\"token operator\">\\</span>\n    &amp;&amp; echo <span class=\"token variable\">$TZ</span> > /etc/timezone</span>\n\n<span class=\"token comment\"># update ë° íŒ¨í‚¤ì§€ ì„¤ì¹˜, init ëª…ë ¹ì–´ ë“±ë¡</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apt update <span class=\"token operator\">\\</span>\n    &amp;&amp; apt install -y sudo sed <span class=\"token operator\">\\</span>\n    &amp;&amp; cat <span class=\"token variable\">$WORKDIR</span>/conf/init.sh >> /bin/init <span class=\"token operator\">\\</span>\n    &amp;&amp; chmod u+x /bin/init</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\n\n<span class=\"token comment\"># Create a database and initialize it</span>\n<span class=\"token assign-left variable\">SQL_FILE_PATH</span><span class=\"token operator\">=</span><span class=\"token string\">\"<span class=\"token variable\">$WORKDIR</span>\"</span>/conf/postgresql_table.sql\n<span class=\"token function\">sudo</span> <span class=\"token function\">sed</span> -i <span class=\"token string\">\"s/{SERVICE_B_SCHEMA_NAME}/<span class=\"token variable\">$DB_SCHEMA_NAME</span>/g\"</span> SQL_FILE_PATH\n<span class=\"token function\">su</span> postgres -c <span class=\"token string\">'psql -U \"$DB_USER\" -c \"CREATE DATABASE $DB_NAME\"'</span>\n<span class=\"token function\">su</span> postgres -c <span class=\"token string\">'psql -U \"$DB_USER\" -d \"$DB_NAME\" -c \"CREATE SCHEMA $DB_SCHEMA_NAME\"'</span>\n<span class=\"token function\">su</span> postgres -c <span class=\"token string\">'psql -U \"$DB_USER\" -d \"$DB_NAME\" -a -f $SQL_FILE_PATH'</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\">docker build <span class=\"token punctuation\">-</span>f Dockerfile_db <span class=\"token punctuation\">-</span>t pg14<span class=\"token punctuation\">:</span>7.1.0 .</code></pre></div>\n</li>\n<li>\n<p>ì™¸ë¶€ DBë¥¼ ì—°ê²°í•˜ëŠ” ê²½ìš°</p>\n<p>â†’ Dockerfile ì‘ì„± X</p>\n<p>â†’ ì„¤ì •íŒŒì¼ì—ì„œ <code class=\"language-text\">DATABASE_HOST</code>  ì£¼ì„ì„ í’€ê³  ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰</p>\n</li>\n</ul>\n</li>\n<li>\n<p>docker-compose ì‘ì„±</p>\n<ul>\n<li>\n<p>ì»¨í…Œì´ë„ˆ ë‚´ë¶€ DB ì´ìš©í•˜ëŠ” ê²½ìš°(docker-compose.yml)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">services:\n    database:\n        image: mypg:7.1.0\n        container_name: db_instance\n        restart: unless-stopped\n        ports:\n          - <span class=\"token variable\">${DB_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${DB_PORT_OUT}</span>\n        volumes:\n          - db_storage:/var/lib/postgresql/data\n        environment:\n          DB_KIND: <span class=\"token variable\">${DB_KIND}</span>\n          DB_NAME: <span class=\"token variable\">${DB_NAME}</span>\n          DB_SCHEMA_NAME: <span class=\"token variable\">${DB_SCHEMA_NAME}</span>\n          DB_USER: <span class=\"token variable\">${DB_USER}</span>\n          POSTGRES_PASSWORD: <span class=\"token variable\">${DB_PASSWORD}</span>\n          TZ: <span class=\"token variable\">${TZ}</span>\n        healthcheck:\n          test: <span class=\"token punctuation\">[</span><span class=\"token string\">\"CMD\"</span>, <span class=\"token string\">\"pg_isready\"</span>, <span class=\"token string\">\"-U\"</span>, <span class=\"token string\">\"postgres\"</span><span class=\"token punctuation\">]</span>\n          interval: 10s\n          timeout: 3s\n          retries: <span class=\"token number\">3</span>\n\n    SERVICE_B:\n        build:\n          context: <span class=\"token builtin class-name\">.</span>\n          dockerfile: Dockerfile\n        image: SERVICE_B:7.1.0\n        container_name: SERVICE_B\n        restart: always\n        depends_on:\n          database:\n            condition: service_healthy\n        ports:\n          - <span class=\"token variable\">${SERVICE_B_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_B_PORT_OUT}</span>\n        environment:\n          NODENAME: <span class=\"token variable\">${SERVICE_B_NAME}</span>\n          DB_HOST: db_instance\n          DB_KIND: <span class=\"token variable\">${DB_KIND}</span>\n          DB_NAME: <span class=\"token variable\">${DB_NAME}</span>\n          DB_SCHEMA_NAME: <span class=\"token variable\">${DB_SCHEMA_NAME}</span>\n          DB_USER: <span class=\"token variable\">${DB_USER}</span>\n          DB_PASSWORD: <span class=\"token variable\">${DB_PASSWORD}</span>\n          DB_PORT: <span class=\"token variable\">${DB_PORT_OUT}</span>\n\n    SERVICE_D:\n        image: SERVICE_D:7.1.0\n        container_name: SERVICE_D\n        restart: always\n        depends_on:\n          database:\n              condition: service_healthy\n        ports:\n          - <span class=\"token variable\">${SERVICE_D_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_D_PORT_OUT}</span>\n          - <span class=\"token variable\">${SERVICE_D_CACHE_PORT_IN}</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">${SERVICE_D_CACHE_PORT_OUT}</span>\n        environment:\n          NODENAME: <span class=\"token variable\">${SERVICE_D_NAME}</span>\n          DB_HOST: db_instance\n          DB_KIND: <span class=\"token variable\">${DB_KIND}</span>\n          DB_NAME: <span class=\"token variable\">${DB_NAME}</span>\n          DB_SCHEMA_NAME: <span class=\"token variable\">${DB_SCHEMA_NAME}</span>\n          DB_USER: <span class=\"token variable\">${DB_USER}</span>\n          DB_PASSWORD: <span class=\"token variable\">${DB_PASSWORD}</span>\n          DB_PORT: <span class=\"token variable\">${DB_PORT_OUT}</span>\n          SERVICE_B_IP: <span class=\"token variable\">${SERVICE_B_IP}</span>\nvolumes:\n  db_storage:\n    driver: <span class=\"token builtin class-name\">local</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token comment\"># .env íŒŒì¼ì€ ê·¸ëƒ¥ ì‹¤í–‰í•´ë„ ì¸ì‹í•¨</span>\n<span class=\"token comment\"># --force-recreate : ì»¨í…Œì´ë„ˆë¥¼ ì‚­ì œ í›„ ì¬ìƒì„±</span>\n<span class=\"token comment\"># docker compose up -d --force-recreate</span>\n\n<span class=\"token comment\"># .env íŒŒì¼ì„ ì—¬ëŸ¬ê°œ ë§Œë“¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰</span>\ndocker-compose --env-file .\\.env.local up -d\n\n<span class=\"token comment\"># DB ì»¨í…Œì´ë„ˆì—ì„œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰</span>\ndocker exec -it db_instance init\n\n<span class=\"token comment\"># ì¢…ë£Œ</span>\ndocker compose down -v</code></pre></div>\n</li>\n<li>\n<p>ì™¸ë¶€ DBë¥¼ ì—°ê²°í•˜ëŠ” ê²½ìš°(docker-compose-external-db.yml)</p>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\">services:\n  SERVICE_B:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    image: SERVICE_B:7.1.0\n    container_name: SERVICE_B\n    restart: always\n    ports:\n      - ${SERVICE_B_PORT_IN}:${SERVICE_B_PORT_OUT}\n    environment:\n      NODENAME: ${SERVICE_B_NAME}\n      DB_HOST: ${DB_HOST}\n      DB_KIND: ${DB_KIND}\n      DB_NAME: ${DB_NAME}\n      DB_SCHEMA_NAME: ${DB_SCHEMA_NAME}\n      DB_USER: ${DB_USER}\n      DB_PASSWORD: ${DB_PASSWORD}\n      DB_PORT: ${DB_PORT_OUT}\n\n  SERVICE_D:\n    image: SERVICE_D:7.1.0\n    container_name: SERVICE_D\n    restart: always\n    ports:\n      - ${SERVICE_D_PORT_IN}:${SERVICE_D_PORT_OUT}\n      - ${SERVICE_D_CACHE_PORT_IN}:${SERVICE_D_CACHE_PORT_OUT}\n    environment:\n      NODENAME: ${SERVICE_D_NAME}\n      DB_HOST: ${DB_HOST}\n      DB_KIND: ${DB_KIND}\n      DB_NAME: ${DB_NAME}\n      DB_SCHEMA_NAME: ${DB_SCHEMA_NAME}\n      DB_USER: ${DB_USER}\n      DB_PASSWORD: ${DB_PASSWORD}\n      DB_PORT: ${DB_PORT_OUT}\n      SERVICE_B_IP: ${SERVICE_B_IP}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"docker\"><pre class=\"language-docker\"><code class=\"language-docker\"><span class=\"token comment\"># 19ë²ˆ ì„¤ì •íŒŒì¼ì„ ì™¸ë¶€ DBì— ì—°ê²°í•˜ëŠ” compose ëª…ë ¹ì–´</span>\ndocker compose --env-file .\\.env.19 -f .\\docker-compose-external-db.yml up -d</code></pre></div>\n</li>\n</ul>\n</li>\n<li>\n<p>ì¢…ë£Œí•˜ê¸°</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># ì¢…ë£Œ ë° ë³¼ë¥¨ ì‚­ì œ</span>\ndocker compose down <span class=\"token punctuation\">-</span>v</code></pre></div>\n</li>\n</ol>\n<h2 id=\"q--a\" style=\"position:relative;\"><a href=\"#q--a\" aria-label=\"q  a permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Q &#x26; A</h2>\n<details>\n    <summary>DB ì»¨í…Œì´ë„ˆì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤ \n    psql: error: connection to server on socket \"/var/run/postgresql/.s.PGSQL.5432\" failed: No such file or directory</summary>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ì´ ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš°ì—ëŠ” PostgreSQL ì„œë²„ê°€ ì‹¤í–‰ë˜ê³  ìˆì§€ ì•Šê±°ë‚˜ ì„œë²„ì— ì ‘ì†í•  ìˆ˜ ìˆëŠ” ì†Œì¼“ íŒŒì¼ì´ ì—†ê¸° ë•Œë¬¸ì¼ ìˆ˜ ìˆë‹¤.\n\ní•´ê²° ë°©ë²•ìœ¼ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê²ƒë“¤ì„ ì‹œë„í•´ ë³¼ ìˆ˜ ìˆë‹¤:\n\n1. PostgreSQL ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ê³ , ì‹¤í–‰ ì¤‘ì´ ì•„ë‹ˆë¼ë©´ ì„œë²„ë¥¼ ì‹œì‘í•œë‹¤.\n    \n  ps aux | grep postgres\n    \n2. ì†Œì¼“ íŒŒì¼ì´ ì—†ê¸° ë•Œë¬¸ì— ì ‘ì†ì´ ì‹¤íŒ¨í•œ ê²ƒì¼ ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ, ì†Œì¼“ íŒŒì¼ì„ ìƒì„±í•´ì¤€ë‹¤.\n\n ì†Œì¼“ íŒŒì¼ì„ ìƒì„±í•˜ë ¤ë©´ **`pg_ctl`** ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. \n \n ì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•  ìˆ˜ ìˆë‹¤:\n    \n  su postgres\n  \n  pg_ctl -w restart</code></pre></div>\n</details>\n<br>\n<details>\n    <summary>ë³¼ë¥¨ì„ ì—¬ëŸ¬ê³³ì—ì„œ ê°™ì´ ì“°ê³  ì‹¶ì–´ìš”</summary>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">volumesì„ ê³µìœ í•´ì„œ ì‚¬ìš©í• ì‹œ ì£¼ì˜í•  ì ì€ ê³µìœ í•  ë³¼ë¥¨ì˜ ì´ë¦„ì„ ì»¨í…Œì´ë„ˆì— ëª…ì‹œí•˜ëŠ” ê²ƒ ë¿ë§Œ ì•„ë‹ˆë¼ ê²½ë¡œë„ ê°™ì•„ì•¼ í•œë‹¤ëŠ” ì ì´ë‹¤.\n\nnodejs ì»¨í…Œì´ë„ˆì˜ ë³¼ë¥¨ì˜ ê²½ë¡œê°€ ë§Œì•½ ì•„ë˜ì²˜ëŸ¼ ë³€ê²½ëœë‹¤ë©´\n\n- shared-data:/test/nodejs\n\ndb ì»¨í…Œì´ë„ˆì˜ ë³¼ë¥¨ì˜ ê²½ë¡œë„ ì•„ë˜ì²˜ëŸ¼ ë°”ê¿”ì¤˜ì•¼ì§€ë§Œ ê°™ì€ ë³¼ë¥¨ì„ ë‘ ì»¨í…Œì´ë„ˆì—ì„œ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.\n\n- shared-data:/test/mysql</code></pre></div>\n</details>\n<br>\n<details>\n    <summary>í˜„ì¬ ìƒíƒœë¥¼ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê³  ì‹¶ì–´ìš”</summary>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># í˜¸ìŠ¤íŠ¸ OSì—ì„œ\ndocker commit -m \"ë©”ì‹œì§€\" ì»¨í…Œì´ë„ˆëª… ì´ë¯¸ì§€ëª…:íƒœê·¸</code></pre></div>\n</details>\n<br>\n<details>\n    <summary>docker-compose vs docker compose, ë¬´ìŠ¨ ì°¨ì´ì¸ê°€ìš”?</summary>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker-compose : êµ¬ë²„ì „, python ê¸°ë°˜\n\ndocker compose : ì‹ ë²„ì „, Goì–¸ì–´ ê¸°ë°˜ + ì‹ ê·œ ëª…ë ¹ì–´ ì¶”ê°€\n\n(ì‹¤í–‰ ì†ë„ëŠ” ë¹„ìŠ·í•˜ë‹¤.)</code></pre></div>\n</details>\n<br>\n<details>\n    <summary>jar íŒŒì¼ ì‹¤í–‰ ì‹œ, Main Classë¥¼ ì°¾ì„ ìˆ˜ ì—†ë‹¤ëŠ” ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤</summary>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[ì°¸ì¡°ê¸€](https://chaelin1211.github.io/study/2021/03/12/springboot-error-01.html)\n\n- Spring bootë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°\n    \n  pom.xmlì— ì•„ë˜ í”ŒëŸ¬ê·¸ì¸ ì¶”ê°€\n    \n  &lt;plugin>\n      &lt;groupId>org.springframework.boot&lt;/groupId>\n      &lt;artifactId>spring-boot-maven-plugin&lt;/artifactId>\n  &lt;/plugin>\n    \n    \n- ìˆœìˆ˜ Javaë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°\n    \n  jar ëŒ€ì‹  warë¡œ íŒ¨í‚¤ì§•í•˜ì—¬ ì‹¤í–‰</code></pre></div>\n</details>\n<br>\n<details>\n    <summary>íŠ¹ì • íŒŒì¼ì˜ í…ìŠ¤íŠ¸ë¥¼ ì°¾ì•„ ë°”ê¾¸ê¸° í•˜ê³  ì‹¶ì–´ìš”</summary>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># file.txt íŒŒì¼ì—ì„œ \"ì°¾ì„ë‚´ìš©\"ì„ \"ë°”ê¿€ë‚´ìš©\"ìœ¼ë¡œ ì°¾ì•„ë°”ê¾¸ê¸°\n# ë°©ë²•1\ntr 'ì°¾ì„ë‚´ìš©' 'ë°”ê¿€ë‚´ìš©' &lt; ë°”ê¿€íŒŒì¼\n\n# ë°©ë²•2\n# -i : íŒŒì¼ì˜ ë‚´ìš©ì„ ë°”ê¿ˆ\n# 's' : ì°¾ì•„ë°”ê¾¸ê¸°\n# 'g' : ëª¨ë“  ë¬¸ìì—´ ë°”ê¾¸ê¸°\nsed -i 's/ì°¾ì„ë‚´ìš©/ë°”ê¿€ë‚´ìš©/g' file.txt</code></pre></div>\n</details>\n<br>\n<details>\n    <summary>ë„ì»¤ ì»¨í…Œì´ë„ˆì˜ ìºì‹œë¥¼ ì‚­ì œí•˜ê³  ì‹¶ì–´ìš”</summary>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">docker system prune --volumes</code></pre></div>\n</details>\n<br>\n<details>\n    <summary>í™˜ê²½ë³€ìˆ˜ ê°’ì´ ì„ íƒë˜ëŠ” ìš°ì„ ìˆœìœ„ëŠ” ë­”ê°€ìš”?(Compose / Dockerfile / Shell / Env)</summary>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1. Compose íŒŒì¼ì— ì§ì ‘ ì…ë ¥í•œ ê°’\n2. ì‰˜ í™˜ê²½ë³€ìˆ˜ë¡œ ë“±ë¡í•œ ê°’\n3. í™˜ê²½ë³€ìˆ˜ íŒŒì¼ë¡œ ì…ë ¥ëœ ê°’(`.env` ë“±)\n4. Dockerfileì„ í†µí•´ ì‚½ì…ëœ ê°’\n\n### **ìš°ì„ ìˆœìœ„ ê²°ì • ì˜ˆì‹œ**\n\nìš°ì„ , Dockerfileë¡œ ì•„ë˜ì™€ ê°™ì´ `seongjin_mysql`ì´ë¼ëŠ” ì´ë¯¸ì§€ë¥¼ ë¹Œë“œí–ˆë‹¤ê³  ê°€ì •í•˜ì.\nFROM mysql:8\nENV MYSQL_ROOT_PASSWORD passwd_from_dockerfile\n\n\nê·¸ë¦¬ê³  ì‰˜ í™˜ê²½ì—ì„œ ì•„ë˜ì™€ ê°™ì´ í™˜ê²½ë³€ìˆ˜ë¥¼ ì§ì ‘ ì…ë ¥í•œë‹¤.\n$ export MYSQL_ROOT_PASSWORD=passwd_from_shell\n\n\në‹¤ìŒìœ¼ë¡œëŠ” `.env` íŒŒì¼ì„ ë§Œë“¤ì–´ ì•„ë˜ì™€ ê°™ì´ í™˜ê²½ë³€ìˆ˜ë¥¼ ì„¤ì •í–ˆë‹¤ê³  ì¹˜ì.\nMYSQL_ROOT_PASSWORD=passwd_from_envfile\n\n\në§ˆì§€ë§‰ìœ¼ë¡œ ë°°í¬ìš© `YAML`ì€ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í–ˆë‹¤ê³  ê°€ì •í•œë‹¤.\nversion: '3.9'\nservices:\n  mysql:\n    image: seongjin_mysql\n    restart: unless-stopped\n    environment:\n      MYSQL_ROOT_PASSWORD: passwd_from_yaml\n\n\nì´ëŸ¬í•œ í™˜ê²½ì—ì„œ `docker compose up`ì„ ì‹¤í–‰í–ˆì„ ë•Œ, í•´ë‹¹ ì„œë¹„ìŠ¤(ì»¨í…Œì´ë„ˆ)ì— ì ìš©ëœ í™˜ê²½ë³€ìˆ˜ `MYSQL_ROOT_PASSWORD`ì˜ ìµœì¢…ê°’ì„ ìƒí™© ë³„ë¡œ ì•Œì•„ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n- ìœ„ì˜ ìƒíƒœ ê·¸ëŒ€ë¡œ ì§„í–‰í–ˆë‹¤ë©´, `MYSQL_ROOT_PASSWORD`ì˜ ìµœì¢…ê°’ì€ `YAML`ì— ì§ì ‘ ì‚½ì…ëœ `passwd_from_yaml`ì´ ëœë‹¤.\n\n- ë§Œì•½ `YAML`ì˜ í™˜ê²½ë³€ìˆ˜ í•­ëª©ì´ `MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}`ë¡œ ëŒ€ì²´ëœë‹¤ë©´, `MYSQL_ROOT_PASSWORD`ì˜ ìµœì¢…ê°’ì€ ì‰˜ì—ì„œ ì»¤ë§¨ë“œë¼ì¸ìœ¼ë¡œ ì…ë ¥ëœ `passwd_from_shell`ì´ ëœë‹¤.\n\n- ë§Œì•½ `YAML`ì˜ í™˜ê²½ë³€ìˆ˜ í•­ëª©ì´ `MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}`ë¡œ ëŒ€ì²´ë˜ê³  ì‰˜ í™˜ê²½ì—ì„œì˜ í™˜ê²½ë³€ìˆ˜ ì…ë ¥ ê³¼ì •ì´ ìƒëµëœë‹¤ë©´, `MYSQL_ROOT_PASSWORD`ì˜ ìµœì¢…ê°’ì€ `.env` íŒŒì¼ì— ì‚½ì…ëœ `passwd_from_envfile`ì´ ëœë‹¤.\n\n- ë§Œì•½ `YAML`ì—ì„œ í™˜ê²½ë³€ìˆ˜ í•­ëª©ì´ ì™„ì „íˆ ì‚­ì œë˜ê³ , ì‰˜ í™˜ê²½ì—ì„œì˜ í™˜ê²½ë³€ìˆ˜ ì…ë ¥ ê³¼ì •ì´ ìƒëµë˜ë©°, `.env` íŒŒì¼ë„ ë”°ë¡œ ë§Œë“¤ì–´ì§€ì§€ ì•Šì•˜ë‹¤ë©´, `MYSQL_ROOT_PASSWORD`ì˜ ìµœì¢…ê°’ì€ Dockerfileì„ í†µí•´ ì‚½ì…ëœ `passwd_from_dockerfile`ì´ ëœë‹¤.</code></pre></div>\n</details>\n<br>\n<hr>\n<br>\n<h2 id=\"ë§ˆì¹˜ë©°\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\" aria-label=\"ë§ˆì¹˜ë©° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë§ˆì¹˜ë©°..</h2>\n<p>ì´ë²ˆ ì‹œê°„ì—ëŠ” ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ ì‹¤í–‰í™˜ê²½ ì„¤ì •ì„ ìë™í™”í•´ë³´ì•˜ë‹¤.</p>\n<p>ë‹¤ìŒ ì‹œê°„ì—ëŠ” ì›ê²© ì €ì¥ì†Œ release ë¸Œëœì¹˜ì— pushê°€ ë°œìƒí•˜ë©´,</p>\n<p>docker ì´ë¯¸ì§€ë¡œ CI/CDí•  ìˆ˜ ìˆë„ë¡ í•´ë³´ì</p>\n<hr>\n<br>\n<p><em>ì°¸ê³ ìë£Œ</em></p>\n<p><em><a href=\"https://docs.docker.com/compose/reference/\">Overview of docker compose CLI | Docker Documentation</a></em></p>\n<p><em><a href=\"https://1mini2.tistory.com/31\">[Docker-Basic (10)] Docker File ì‚¬ìš©í•˜ê¸° - ì‹¤ìŠµ2 MARIA DB (tistory.com)</a></em></p>\n<p><em><a href=\"https://www.daleseo.com/dockerfile/\">Dockerfileì—ì„œ ìì£¼ ì“°ì´ëŠ” ëª…ë ¹ì–´ | Engineering Blog by Dale Seo</a></em></p>\n<p><em><a href=\"https://velog.io/@seheon99/%EC%B5%9C%EA%B3%A0%EC%9D%98-Dockerfile-%EC%9E%91%EC%84%B1%EC%9D%84-%EC%9C%84%ED%95%9C-%EB%AA%87-%EA%B0%80%EC%A7%80-%EC%8A%B5%EA%B4%80%EB%93%A4\">ìµœê³ ì˜ Dockerfile ì‘ì„±ì„ ìœ„í•œ ëª‡ ê°€ì§€ ìŠµê´€ë“¤ (velog.io)</a></em></p>\n<p><em><a href=\"https://narup.tistory.com/204\">[Dockerfile] Dockerfileì´ë€? Dockerfile ì˜µì…˜ â€” ì‹œê°„ì´ ë©ˆì¶”ëŠ” ì¥ì†Œ (tistory.com)</a></em></p>\n<p><em><a href=\"https://mino-park7.github.io/docker/2018/12/10/dockerfile/\">Dockerfile ì‘ì„±ë°©ë²• ë° ì½ëŠ” ë²• Â· MinhoPark (mino-park7.github.io)</a></em></p>\n<p><em><a href=\"https://seongjin.me/environment-variables-in-docker-compose/\">Docker Composeì—ì„œ ê° ì„œë¹„ìŠ¤ ì»¨í…Œì´ë„ˆì— ì“°ì´ëŠ” í™˜ê²½ë³€ìˆ˜ë¥¼ ë‹¤ë£¨ëŠ” ë°©ë²• (seongjin.me)</a></em></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EC%9D%B4%EC%A0%84%ED%8E%B8-%EC%9A%94%EC%95%BD\">ì´ì „í¸ ìš”ì•½</a></li>\n<li><a href=\"#%EB%AA%A9%ED%91%9C\">ëª©í‘œ</a></li>\n<li><a href=\"#%EC%97%AC%EC%A0%95\">ì—¬ì •</a></li>\n<li><a href=\"#q--a\">Q &#x26; A</a></li>\n<li><a href=\"#%EB%A7%88%EC%B9%98%EB%A9%B0\">ë§ˆì¹˜ë©°..</a></li>\n</ul>\n</div>","frontmatter":{"date":"December 25, 2022","title":"MSA ë„ì»¤ë¼ì´ì§•(Dockerizing) 2í¸, ê°œì„ í•˜ê¸°","categories":"infra","author":"ì£¼ë…","emoji":"ğŸ”®"},"fields":{"slug":"/dockerize-msa-improve/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://www.junwork.net","comments":{"utterances":{"repo":"junwork123/blog-comments"}}}}},"pageContext":{"slug":"/dockerize-msa-develop/","nextSlug":"/dockerize-msa-improve/","prevSlug":""}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}